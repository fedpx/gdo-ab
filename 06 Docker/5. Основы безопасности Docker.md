# Задание
Настройка безопасности Docker Daemon и сканирование образа
1. Настройте безопасность Docker Daemon:
	- Ограничьте доступ к Docker Daemon:
	- Настройте использование группы docker, чтобы только её участники могли управлять контейнерами. 
	- Проверьте права доступа к файлу docker.sock и ограничьте их для безопасности.
2. Просканируйте созданный образ на уязвимости:
	- Выберите созданный вами ранее Docker-образ.
	- Используйте инструмент для сканирования (например, Trivy).
	- Проанализируйте результат сканирования, обратите внимание на уязвимости и примите меры по их устранению.

Конечный результат:
Docker Daemon настроен с учётом базовых мер безопасности.
Образ просканирован на наличие уязвимостей, и вы получили информацию о возможных рисках.

---
# 1. Настройка безопасности Docker Daemon
```
# Добавляем текущего пользователя в группу docker
sudo usermod -aG docker $USER

# Проверяем доступ к docker.sock (дожен быть root:docker 660)
ls -l /var/run/docker.sock
```
![[CleanShot 2025-09-08 at 18.36.40@2x.png]]
# 2. Сканирование образа на уязвимости
Устанавливаем Trivy по документации - https://trivy.dev/latest/getting-started/installation/. 
## Создание своего образа
Для дальнейшего сравнения забираем базовый образ `nginx:latest` из Docker Hub.
```
docker pill nginx:latest
```

Соберём собственный образ `nginx_fixed` с на основе базового `nginx:latest` только обновим в нем пакеты.

Dockerfile будет выглядеть вот так:
```
FROM nginx:latest
RUN apt-get update && apt-get upgrade -y && rm -rf /var/lib/apt/lists/*
```
Собираем свой образ:
```
docker build -t nginx_fixed .
```
![[CleanShot 2025-09-08 at 19.25.34.png]]
## Сравнение образов
```
# Выполняем сканирование образов 
trivy image nginx:latest
trivy image nginx_fixed:latest
```

Результат сканирования `nginx:latest`:
![[CleanShot 2025-09-08 at 19.28.54.png]]
Результат сканирования `nginx_fixed:latest`:
![[CleanShot 2025-09-08 at 19.29.22.png]]
Общее количество уязвимостей уменьшилось на 20, из них мы пофиксили 2 критические и 7 уязвимостей высокого риска.